<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Validation</title>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .error { color: red; font-size: 12px; margin-top: 5px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        select, input { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        .error-border { border-color: red !important; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <div x-data="testValidation()">
        <h1>Test Validation ƒê·ªãa Ch·ªâ</h1>
        
        <form @submit.prevent="validateForm()">
            <div class="form-group">
                <label>H·ªç v√† t√™n *</label>
                <input type="text" x-model="customer.name" :class="formErrors.name ? 'error-border' : ''">
                <div x-show="formErrors.name" x-text="formErrors.name" class="error"></div>
            </div>

            <div class="form-group">
                <label>S·ªë ƒëi·ªán tho·∫°i *</label>
                <input type="text" x-model="customer.phone" :class="formErrors.phone ? 'error-border' : ''">
                <div x-show="formErrors.phone" x-text="formErrors.phone" class="error"></div>
            </div>

            <div class="form-group">
                <label>T·ªânh/Th√†nh ph·ªë *</label>
                <select x-model="selectedProvince" :class="formErrors.province ? 'error-border' : ''">
                    <option value="">Ch·ªçn t·ªânh/th√†nh ph·ªë</option>
                    <option value="1">H√† N·ªôi</option>
                    <option value="2">TP. H·ªì Ch√≠ Minh</option>
                    <option value="3">ƒê√† N·∫µng</option>
                </select>
                <div x-show="formErrors.province" x-text="formErrors.province" class="error"></div>
            </div>

            <div class="form-group">
                <label>Qu·∫≠n/Huy·ªán *</label>
                <select x-model="selectedDistrict" :class="formErrors.district ? 'error-border' : ''">
                    <option value="">Ch·ªçn qu·∫≠n/huy·ªán</option>
                    <option value="1">Qu·∫≠n 1</option>
                    <option value="2">Qu·∫≠n 2</option>
                    <option value="3">Qu·∫≠n 3</option>
                </select>
                <div x-show="formErrors.district" x-text="formErrors.district" class="error"></div>
            </div>

            <div class="form-group">
                <label>Ph∆∞·ªùng/X√£ *</label>
                <select x-model="selectedWard" :class="formErrors.ward ? 'error-border' : ''">
                    <option value="">Ch·ªçn ph∆∞·ªùng/x√£</option>
                    <option value="1">Ph∆∞·ªùng 1</option>
                    <option value="2">Ph∆∞·ªùng 2</option>
                    <option value="3">Ph∆∞·ªùng 3</option>
                </select>
                <div x-show="formErrors.ward" x-text="formErrors.ward" class="error"></div>
            </div>

            <div class="form-group">
                <label>ƒê·ªãa ch·ªâ c·ª• th·ªÉ *</label>
                <input type="text" x-model="streetAddress" :class="formErrors.streetAddress ? 'error-border' : ''">
                <div x-show="formErrors.streetAddress" x-text="formErrors.streetAddress" class="error"></div>
            </div>

            <button type="submit">Ki·ªÉm tra validation</button>
        </form>

        <div style="margin-top: 20px; padding: 10px; background: #f5f5f5; border-radius: 4px;">
            <h3>Debug Info:</h3>
            <p><strong>selectedProvince:</strong> <span x-text="selectedProvince"></span> (type: <span x-text="typeof selectedProvince"></span>)</p>
            <p><strong>selectedDistrict:</strong> <span x-text="selectedDistrict"></span> (type: <span x-text="typeof selectedDistrict"></span>)</p>
            <p><strong>selectedWard:</strong> <span x-text="selectedWard"></span> (type: <span x-text="typeof selectedWard"></span>)</p>
            <p><strong>streetAddress:</strong> <span x-text="streetAddress"></span></p>
            <p><strong>Validation Result:</strong> <span x-text="validationResult"></span></p>
        </div>
    </div>

    <script>
        function testValidation() {
            return {
                customer: { name: '', phone: '' },
                selectedProvince: '',
                selectedDistrict: '',
                selectedWard: '',
                streetAddress: '',
                validationResult: 'Ch∆∞a ki·ªÉm tra',
                formErrors: {
                    name: '',
                    phone: '',
                    province: '',
                    district: '',
                    ward: '',
                    streetAddress: ''
                },

                validateForm() {
                    console.log('üîç validateForm() called');
                    this.clearFormErrors();
                    let isValid = true;

                    // Debug current form values
                    console.log('üîç Form validation debug:');
                    console.log('  - customer.name:', this.customer.name);
                    console.log('  - customer.phone:', this.customer.phone);
                    console.log('  - selectedProvince:', this.selectedProvince, typeof this.selectedProvince);
                    console.log('  - selectedDistrict:', this.selectedDistrict, typeof this.selectedDistrict);
                    console.log('  - selectedWard:', this.selectedWard, typeof this.selectedWard);
                    console.log('  - streetAddress:', this.streetAddress);

                    // Validate name
                    if (!this.customer.name.trim()) {
                        console.log('üîç Name validation failed');
                        this.formErrors.name = 'Vui l√≤ng nh·∫≠p h·ªç v√† t√™n';
                        isValid = false;
                    }

                    // Validate phone
                    if (!this.customer.phone.trim()) {
                        console.log('üîç Phone validation failed - empty');
                        this.formErrors.phone = 'Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i';
                        isValid = false;
                    }

                    // Validate address - check for empty string, null, undefined, or just whitespace
                    if (!this.selectedProvince || String(this.selectedProvince).trim() === '') {
                        console.log('üîç Province validation failed - selectedProvince:', this.selectedProvince);
                        this.formErrors.province = 'Vui l√≤ng ch·ªçn t·ªânh/th√†nh ph·ªë';
                        isValid = false;
                    }

                    if (!this.selectedDistrict || String(this.selectedDistrict).trim() === '') {
                        console.log('[object Object]istrict validation failed - selectedDistrict:', this.selectedDistrict);
                        this.formErrors.district = 'Vui l√≤ng ch·ªçn qu·∫≠n/huy·ªán';
                        isValid = false;
                    }

                    if (!this.selectedWard || String(this.selectedWard).trim() === '') {
                        console.log('üîç Ward validation failed - selectedWard:', this.selectedWard);
                        this.formErrors.ward = 'Vui l√≤ng ch·ªçn ph∆∞·ªùng/x√£';
                        isValid = false;
                    }

                    if (!this.streetAddress.trim()) {
                        console.log('üîç Street address validation failed');
                        this.formErrors.streetAddress = 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ c·ª• th·ªÉ';
                        isValid = false;
                    }

                    console.log('üîç Form validation result:', isValid);
                    console.log('üîç Form errors:', this.formErrors);

                    this.validationResult = isValid ? 'PASS - T·∫•t c·∫£ tr∆∞·ªùng h·ª£p l·ªá' : 'FAIL - C√≥ l·ªói validation';
                    
                    return isValid;
                },

                clearFormErrors() {
                    Object.keys(this.formErrors).forEach(key => {
                        this.formErrors[key] = '';
                    });
                }
            }
        }
    </script>
</body>
</html>
